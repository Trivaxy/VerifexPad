services:
  # Long-lived Verifex compiler container
  verifex-compiler:
    build:
      context: ./backend
      dockerfile: Dockerfile
      args:
        - VERIFEX_VERSION=${VERIFEX_VERSION:-master}
    image: verifex-compiler
    container_name: ${VERIFEX_CONTAINER_NAME:-verifexpad-compiler}
    command: ["tail", "-f", "/dev/null"]
    restart: unless-stopped
    read_only: true
    cap_drop:
      - ALL
    security_opt:
      - no-new-privileges
    network_mode: none
    tmpfs:
      - /tmp/verifexpad:rw,exec,mode=1777
